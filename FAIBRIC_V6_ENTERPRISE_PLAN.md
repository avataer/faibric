# Faibric V6: Enterprise SaaS Platform

## Vision

Transform Faibric from an AI app builder into a **complete SaaS platform** where customers (SMBs, startups) can build and run their entire business - with security, billing, analytics, AI, and everything pre-built.

---

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FAIBRIC ENTERPRISE PLATFORM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                            CUSTOMER LAYER (Multi-tenant)                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚Customer Aâ”‚  â”‚Customer Bâ”‚  â”‚Customer Câ”‚  â”‚Customer Dâ”‚  â”‚Customer Eâ”‚  ...     â”‚    â”‚
â”‚  â”‚  â”‚(SaaS Co) â”‚  â”‚(E-comm)  â”‚  â”‚(Agency)  â”‚  â”‚(Startup) â”‚  â”‚(SMB)     â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â”‚       â”‚             â”‚             â”‚             â”‚             â”‚                 â”‚    â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚    â”‚
â”‚  â”‚                                   â”‚                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                      â–¼                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                           FAIBRIC CORE SERVICES                                  â”‚    â”‚
â”‚  â”‚                                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚   AUTH &    â”‚ â”‚  BILLING    â”‚ â”‚  ANALYTICS  â”‚ â”‚    AI       â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  SECURITY   â”‚ â”‚  (Stripe/   â”‚ â”‚ (Mixpanel/  â”‚ â”‚  GATEWAY    â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  (Tenant    â”‚ â”‚   PayPal)   â”‚ â”‚    GA)      â”‚ â”‚ (Multi-LLM) â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  Isolation) â”‚ â”‚             â”‚ â”‚             â”‚ â”‚             â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚                                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚   STORAGE   â”‚ â”‚  MESSAGING  â”‚ â”‚   FORUM     â”‚ â”‚  CHECKOUT   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚  (S3/R2)    â”‚ â”‚  (Email/    â”‚ â”‚   BOARD     â”‚ â”‚  (Stripe/   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚             â”‚ â”‚   Chat)     â”‚ â”‚             â”‚ â”‚   PayPal)   â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚                                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚  â”‚ RECOMMENDER â”‚ â”‚   ADMIN     â”‚ â”‚  MARKETING  â”‚ â”‚    CODE     â”‚               â”‚    â”‚
â”‚  â”‚  â”‚   ENGINE    â”‚ â”‚   PANEL     â”‚ â”‚  ANALYSIS   â”‚ â”‚   LIBRARY   â”‚               â”‚    â”‚
â”‚  â”‚  â”‚             â”‚ â”‚  (Drag&Drop)â”‚ â”‚             â”‚ â”‚  (Reusable) â”‚               â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
â”‚  â”‚                                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Phases

### Phase 1: Security & Multi-Tenancy Foundation
**Timeline: 2-3 weeks**
**Requirement: #1 (Security)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MULTI-TENANT SECURITY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Every request includes:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Authorization: Bearer {JWT}                              â”‚   â”‚
â”‚  â”‚  X-Tenant-ID: {customer_uuid}                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Database Level:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ALL tables have: tenant_id (indexed, required)           â”‚   â”‚
â”‚  â”‚  ALL queries filtered by: WHERE tenant_id = current       â”‚   â”‚
â”‚  â”‚  Row-level security (RLS) in PostgreSQL                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Storage Level:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Files stored at: /tenant_{uuid}/...                      â”‚   â”‚
â”‚  â”‚  Signed URLs with tenant validation                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [ ] Add `tenant_id` to all models
- [ ] Implement middleware for tenant isolation
- [ ] Add Row-Level Security (RLS) in PostgreSQL
- [ ] Tenant-scoped file storage paths
- [ ] Audit logging for security events
- [ ] Rate limiting per tenant

**Files to Create/Modify:**
```
backend/apps/tenants/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # Tenant, TenantMembership
â”œâ”€â”€ middleware.py      # TenantIsolationMiddleware
â”œâ”€â”€ permissions.py     # TenantPermission class
â””â”€â”€ utils.py           # get_current_tenant()
```

---

### Phase 2: Unified Billing System
**Timeline: 2-3 weeks**
**Requirement: #2 (Single billing entry)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BILLING ARCHITECTURE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Customer enters once:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Credit Card (via Stripe Elements - PCI compliant)      â”‚   â”‚
â”‚  â”‚  â€¢ Billing Name                                           â”‚   â”‚
â”‚  â”‚  â€¢ Billing Address                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              STRIPE CUSTOMER OBJECT                       â”‚   â”‚
â”‚  â”‚  â€¢ Payment method attached                                â”‚   â”‚
â”‚  â”‚  â€¢ Auto-charge enabled                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              MONTHLY INVOICE (auto-generated)             â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Faibric Platform Fee .................... $49.00         â”‚   â”‚
â”‚  â”‚  AI Tokens Used (125,000) ................ $12.50         â”‚   â”‚
â”‚  â”‚  Storage (50GB) .......................... $5.00          â”‚   â”‚
â”‚  â”‚  Bandwidth (200GB) ....................... $8.00          â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚   â”‚
â”‚  â”‚  TOTAL ................................... $74.50         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [ ] Stripe integration (Customer, PaymentMethod, Subscription)
- [ ] PayPal as backup payment method
- [ ] Usage tracking service (tokens, storage, bandwidth)
- [ ] Invoice generation system
- [ ] Billing dashboard for customers
- [ ] Webhook handlers for payment events

**Files to Create:**
```
backend/apps/billing/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # BillingProfile, Invoice, UsageRecord
â”œâ”€â”€ services.py        # StripeService, PayPalService
â”œâ”€â”€ webhooks.py        # stripe_webhook, paypal_webhook
â”œâ”€â”€ tasks.py           # generate_monthly_invoice
â””â”€â”€ views.py           # BillingViewSet
```

---

### Phase 3: Analytics & Tracking âœ… COMPLETED
**Timeline: 1-2 weeks**
**Requirements: #3 (Analytics funnels), #4 (Email subscriptions)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ANALYTICS ARCHITECTURE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Customer's End Users                                            â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              FAIBRIC ANALYTICS PROXY                      â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  trackEvent('signup_started', { plan: 'pro' })           â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â”œâ”€â”€â–º Mixpanel (if configured)                    â”‚   â”‚
â”‚  â”‚         â”œâ”€â”€â–º Google Analytics (if configured)            â”‚   â”‚
â”‚  â”‚         â”œâ”€â”€â–º Faibric Internal Analytics                  â”‚   â”‚
â”‚  â”‚         â””â”€â”€â–º Customer's custom webhook                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Pre-built Funnels:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Signup Funnel (visit â†’ signup â†’ verify â†’ active)       â”‚   â”‚
â”‚  â”‚  â€¢ Purchase Funnel (view â†’ cart â†’ checkout â†’ purchase)    â”‚   â”‚
â”‚  â”‚  â€¢ Engagement Funnel (visit â†’ interact â†’ return)          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Email Subscription Service:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  POST /api/v1/subscribe/                                  â”‚   â”‚
â”‚  â”‚  { "email": "...", "list": "newsletter" }                â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Integrates with: Mailchimp, SendGrid, ConvertKit        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Analytics proxy service
- [x] Mixpanel integration
- [x] Google Analytics 4 integration
- [x] Pre-built funnel templates (signup, purchase, onboarding, engagement)
- [x] Email subscription service
- [x] Mailchimp/SendGrid/ConvertKit integration
- [x] Unsubscribe handling (GDPR compliant)

**Files to Create:**
```
backend/apps/analytics/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # Event, Funnel, FunnelStep
â”œâ”€â”€ services.py        # MixpanelService, GAService
â”œâ”€â”€ views.py           # track_event, get_funnel_stats

backend/apps/email_lists/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # EmailList, Subscriber
â”œâ”€â”€ services.py        # MailchimpService, SendGridService
â”œâ”€â”€ views.py           # subscribe, unsubscribe
```

---

### Phase 4: AI Chat & Support Bot âœ… COMPLETED
**Timeline: 2 weeks**
**Requirements: #5 (Chat widget), #6 (Multi-LLM)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI CHAT ARCHITECTURE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Embeddable Widget (for customer's websites):                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  <script src="https://faibric.com/chat.js"               â”‚   â”‚
â”‚  â”‚          data-app-id="xxx" data-theme="dark">            â”‚   â”‚
â”‚  â”‚  </script>                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              MULTI-LLM ROUTER                             â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Customer configures preferred LLM:                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ OpenAI  â”‚ â”‚Anthropicâ”‚ â”‚ Gemini  â”‚ â”‚  Grok   â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ GPT-4o  â”‚ â”‚ Claude  â”‚ â”‚  Pro    â”‚ â”‚         â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Fallback chain: Primary â†’ Secondary â†’ Tertiary          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              KNOWLEDGE BASE                               â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â€¢ Customer uploads docs, FAQs                            â”‚   â”‚
â”‚  â”‚  â€¢ Auto-indexed with embeddings                           â”‚   â”‚
â”‚  â”‚  â€¢ RAG retrieval for context                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Multi-LLM router (OpenAI, Anthropic, Gemini, Grok)
- [x] Embeddable chat widget API (public endpoints)
- [ ] WebSocket for real-time chat (deferred - HTTP polling works)
- [x] Knowledge base support (system_prompt + knowledge_base fields)
- [ ] RAG with vector embeddings (deferred - basic context works)
- [x] Chat history storage (ChatSession, ChatMessage models)
- [x] Human handoff to support agent (escalate endpoint)

**Files to Create:**
```
backend/apps/chat/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # Conversation, Message, KnowledgeBase
â”œâ”€â”€ llm_router.py      # MultiLLMRouter
â”œâ”€â”€ embeddings.py      # VectorStore, embed_document
â”œâ”€â”€ consumers.py       # ChatConsumer (WebSocket)
â””â”€â”€ views.py           # ChatViewSet

frontend/src/components/ChatWidget/
â”œâ”€â”€ ChatWidget.tsx
â”œâ”€â”€ ChatBubble.tsx
â””â”€â”€ index.ts
```

---

### Phase 5: Messaging & Communication âœ… COMPLETED
**Timeline: 2 weeks**
**Requirement: #7 (Messaging everywhere)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  UNIFIED MESSAGING SERVICE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              MESSAGE ORCHESTRATOR                         â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  send_message(                                            â”‚   â”‚
â”‚  â”‚    recipient="user@example.com",                          â”‚   â”‚
â”‚  â”‚    channels=["email", "sms", "push", "in_app"],          â”‚   â”‚
â”‚  â”‚    template="welcome",                                    â”‚   â”‚
â”‚  â”‚    data={ "name": "John" }                               â”‚   â”‚
â”‚  â”‚  )                                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â–¼                 â–¼                 â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   EMAIL   â”‚     â”‚    SMS    â”‚     â”‚   PUSH    â”‚             â”‚
â”‚  â”‚ (SendGrid â”‚     â”‚ (Twilio)  â”‚     â”‚ (Firebase â”‚             â”‚
â”‚  â”‚  Mailgun) â”‚     â”‚           â”‚     â”‚   APNS)   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                  â”‚
â”‚  Features:                                                       â”‚
â”‚  â€¢ Template engine (Handlebars)                                  â”‚
â”‚  â€¢ Delivery tracking                                             â”‚
â”‚  â€¢ Preference management (user chooses channels)                 â”‚
â”‚  â€¢ Batch sending                                                 â”‚
â”‚  â€¢ Scheduling                                                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Message orchestrator service (MessagingService)
- [x] Email provider (SendGrid, SMTP)
- [x] SMS provider (Twilio)
- [x] Push notifications (Firebase)
- [x] In-app notifications
- [x] Template engine with variables
- [ ] User preference management (deferred)

**Files to Create:**
```
backend/apps/messaging/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # MessageTemplate, MessageLog, Preference
â”œâ”€â”€ orchestrator.py    # send_message, batch_send
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ email.py       # SendGridProvider, MailgunProvider
â”‚   â”œâ”€â”€ sms.py         # TwilioProvider
â”‚   â””â”€â”€ push.py        # FirebaseProvider
â””â”€â”€ views.py           # MessageViewSet
```

---

### Phase 6: Forum & Community âœ… COMPLETED
**Timeline: 1-2 weeks**
**Requirement: #8 (Forum board)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FORUM SERVICE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Forum Structure:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Category (e.g., "General", "Support", "Feature Req")     â”‚   â”‚
â”‚  â”‚    â””â”€â”€ Topic (thread)                                     â”‚   â”‚
â”‚  â”‚          â””â”€â”€ Post (reply)                                 â”‚   â”‚
â”‚  â”‚                â””â”€â”€ Reaction (like, helpful, etc.)         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Features:                                                       â”‚
â”‚  â€¢ Markdown support                                              â”‚
â”‚  â€¢ @mentions and notifications                                   â”‚
â”‚  â€¢ Pinned/sticky topics                                          â”‚
â”‚  â€¢ Moderation tools                                              â”‚
â”‚  â€¢ Search                                                        â”‚
â”‚  â€¢ User reputation/badges                                        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Forum models (Category, Board, Thread, Post, Reaction)
- [x] Rich text editor (Markdown rendering)
- [ ] Notification on reply/@mention (deferred)
- [x] Moderation features (reports, bans, delete)
- [ ] Search with full-text index (deferred)
- [x] User reactions (upvote/downvote with score)

**Files to Create:**
```
backend/apps/forum/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # Category, Topic, Post, Reaction
â”œâ”€â”€ views.py           # ForumViewSet
â””â”€â”€ search.py          # full-text search

frontend/src/components/Forum/
â”œâ”€â”€ ForumList.tsx
â”œâ”€â”€ TopicView.tsx
â”œâ”€â”€ PostEditor.tsx
â””â”€â”€ index.ts
```

---

### Phase 7: File Storage âœ… COMPLETED
**Timeline: 1 week**
**Requirement: #9 (File storage)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     STORAGE SERVICE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              STORAGE API                                  â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  POST /api/v1/storage/upload/                            â”‚   â”‚
â”‚  â”‚  GET  /api/v1/storage/{file_id}/                         â”‚   â”‚
â”‚  â”‚  DELETE /api/v1/storage/{file_id}/                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              STORAGE BACKENDS                             â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚AWS S3   â”‚  â”‚Cloudfl. â”‚  â”‚GCP     â”‚  â”‚ Local   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚         â”‚  â”‚   R2    â”‚  â”‚Storage â”‚  â”‚ (Dev)   â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Features:                                                       â”‚
â”‚  â€¢ Tenant-isolated paths (/tenant_xxx/...)                       â”‚
â”‚  â€¢ Signed URLs (time-limited access)                             â”‚
â”‚  â€¢ Image optimization (resize, compress)                         â”‚
â”‚  â€¢ CDN integration                                               â”‚
â”‚  â€¢ Virus scanning                                                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Storage abstraction layer (BaseStorageProvider)
- [x] S3/R2/Local backends
- [x] Signed URL generation
- [x] Image processing (thumbnails, resize, optimize)
- [x] CDN integration support
- [x] Usage tracking (StorageUsage model)

**Files to Create:**
```
backend/apps/storage/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # StoredFile
â”œâ”€â”€ backends/
â”‚   â”œâ”€â”€ s3.py
â”‚   â”œâ”€â”€ r2.py
â”‚   â””â”€â”€ local.py
â”œâ”€â”€ services.py        # upload, get_signed_url, delete
â””â”€â”€ views.py           # StorageViewSet
```

---

### Phase 8: Recommendation Engine âœ… COMPLETED
**Timeline: 2-3 weeks** â†’ Completed Nov 27, 2025
**Requirement: #10 (Recommendations)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  RECOMMENDATION ENGINE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              DATA INGESTION                               â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â€¢ User events (views, clicks, purchases)                 â”‚   â”‚
â”‚  â”‚  â€¢ Item catalog (products, content)                       â”‚   â”‚
â”‚  â”‚  â€¢ User profiles (preferences)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              RECOMMENDATION ALGORITHMS                    â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚Collaborativeâ”‚  â”‚Content-Basedâ”‚  â”‚  Hybrid     â”‚       â”‚   â”‚
â”‚  â”‚  â”‚ Filtering   â”‚  â”‚ Filtering   â”‚  â”‚             â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Strategies:                                              â”‚   â”‚
â”‚  â”‚  â€¢ "Similar items"                                        â”‚   â”‚
â”‚  â”‚  â€¢ "Users also bought"                                    â”‚   â”‚
â”‚  â”‚  â€¢ "Trending in category"                                 â”‚   â”‚
â”‚  â”‚  â€¢ "Personalized for you"                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              API                                          â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  GET /api/v1/recommend/?user_id=xxx&type=similar_items   â”‚   â”‚
â”‚  â”‚  â†’ [{ item_id, score, reason }, ...]                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Event ingestion pipeline
- [x] Item catalog indexing
- [x] Collaborative filtering algorithm
- [x] Content-based filtering (embeddings)
- [x] A/B testing for algorithms
- [x] Real-time recommendation API

**Files Created:**
```
backend/apps/recommendations/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ apps.py
â”œâ”€â”€ models.py          # ItemCatalog, UserProfile, UserEvent, RecommendationModel, RecommendationRequest, ABExperiment
â”œâ”€â”€ algorithms/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ collaborative.py  # User-based & item-based collaborative filtering
â”‚   â”œâ”€â”€ content_based.py  # Embedding-based content similarity
â”‚   â”œâ”€â”€ popularity.py     # Popular, trending, best sellers
â”‚   â””â”€â”€ hybrid.py         # Combined recommendation strategy
â”œâ”€â”€ services.py        # EventIngestionService, RecommendationService, CatalogService
â”œâ”€â”€ serializers.py     # API serializers
â”œâ”€â”€ views.py           # ItemCatalogViewSet, EventTrackingViewSet, RecommendationViewSet
â”œâ”€â”€ urls.py
â”œâ”€â”€ admin.py
â””â”€â”€ migrations/
```

**API Endpoints:**
- `GET/POST /api/recommendations/catalog/` - Item catalog CRUD
- `POST /api/recommendations/catalog/bulk_upload/` - Bulk catalog upload
- `GET /api/recommendations/catalog/{id}/similar/` - Similar items
- `POST /api/recommendations/events/track/` - Track single event
- `POST /api/recommendations/events/batch/` - Batch event tracking
- `GET /api/recommendations/recommend/` - Get recommendations by strategy
- `GET /api/recommendations/recommend/personalized/` - Personalized for user
- `GET /api/recommendations/recommend/similar/` - Similar items
- `GET /api/recommendations/recommend/trending/` - Trending items
- `GET /api/recommendations/recommend/popular/` - Popular items
- `POST /api/recommendations/recommend/track_click/` - Track recommendation clicks
- `GET/POST /api/recommendations/models/` - Recommendation models
- `POST /api/recommendations/models/{id}/train/` - Train a model
- `GET/POST /api/recommendations/experiments/` - A/B experiments

**Recommendation Strategies:**
- `personalized` - Personalized for specific user
- `similar_items` - Items similar to a given item
- `also_bought` - Users also bought
- `trending` - Trending items
- `popular` - Popular items
- `new_arrivals` - New items
- `top_rated` - Highest rated
- `best_sellers` - Best sellers

---

### Phase 9: Checkout System âœ… COMPLETED
**Timeline: 2 weeks**
**Requirement: #11 (PayPal + Stripe checkout)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CHECKOUT SERVICE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Customer's End User                                             â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              CHECKOUT PAGE                                â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  Cart Summary                                        â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Product A ............................ $49.99       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Product B ............................ $29.99       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Total: $79.98                                       â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Payment Methods:                                         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚   â”‚
â”‚  â”‚  â”‚   ğŸ’³ Stripe  â”‚  â”‚   ğŸ…¿ï¸ PayPal  â”‚                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Backend Flow:                                                   â”‚
â”‚  1. Create PaymentIntent (Stripe) or Order (PayPal)              â”‚
â”‚  2. Customer completes payment                                   â”‚
â”‚  3. Webhook confirms payment                                     â”‚
â”‚  4. Order fulfilled, email sent                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Cart/Order models (Product, Cart, CartItem, Order, OrderItem, Payment, Coupon)
- [x] Stripe Checkout integration (PaymentIntent, webhooks)
- [x] PayPal SDK integration (create/capture order)
- [x] Webhook handlers (Stripe events)
- [x] Order fulfillment pipeline
- [ ] Receipt/invoice emails (deferred)
- [x] Refund handling

**Files to Create:**
```
backend/apps/checkout/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # Cart, Order, OrderItem, Payment
â”œâ”€â”€ stripe_service.py
â”œâ”€â”€ paypal_service.py
â”œâ”€â”€ webhooks.py
â””â”€â”€ views.py           # CheckoutViewSet

frontend/src/components/Checkout/
â”œâ”€â”€ CartSummary.tsx
â”œâ”€â”€ PaymentForm.tsx
â”œâ”€â”€ OrderConfirmation.tsx
â””â”€â”€ index.ts
```

---

### Phase 10: Client Cabinets âœ… COMPLETED
**Timeline: 1-2 weeks**
**Requirement: #12 (Client cabinets)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIENT CABINET                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Each customer's end-user gets a "cabinet" (dashboard):          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Welcome, John!                              [Logout]     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚  My Orders  â”‚  â”‚My Subscript.â”‚  â”‚  My Files   â”‚       â”‚   â”‚
â”‚  â”‚  â”‚     12      â”‚  â”‚   Active    â”‚  â”‚    24 GB    â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Recent Activity:                                         â”‚   â”‚
â”‚  â”‚  â€¢ Order #1234 shipped                                    â”‚   â”‚
â”‚  â”‚  â€¢ Invoice available                                      â”‚   â”‚
â”‚  â”‚  â€¢ New message from support                               â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  [Edit Profile] [Billing] [Support]                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] End-user authentication (separate from customer)
- [x] Profile management
- [x] Order history view
- [ ] Subscription management (deferred)
- [x] File manager integration
- [x] Support ticket creation
- [x] Notification center

**Files to Create:**
```
backend/apps/cabinet/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # EndUser, Profile
â”œâ”€â”€ views.py           # CabinetViewSet

frontend/src/components/Cabinet/
â”œâ”€â”€ Dashboard.tsx
â”œâ”€â”€ OrderHistory.tsx
â”œâ”€â”€ ProfileEditor.tsx
â””â”€â”€ index.ts
```

---

### Phase 11: Admin Panel (Drag & Drop) âœ… COMPLETED
**Timeline: 3-4 weeks**
**Requirement: #13 (Admin with WYSIWYG, templates)**
**Status: COMPLETED - November 27, 2025**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ADMIN PANEL BUILDER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [Components]  â”‚           CANVAS              â”‚ [Props] â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚                               â”‚ â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚  ğŸ“Š Chart      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ Title:  â”‚   â”‚
â”‚  â”‚  ğŸ“‹ Table      â”‚  â”‚     Dashboard Header    â”‚  â”‚ [____]  â”‚   â”‚
â”‚  â”‚  ğŸ“ Form       â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚         â”‚   â”‚
â”‚  â”‚  ğŸ”˜ Button     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ Color:  â”‚   â”‚
â”‚  â”‚  ğŸ“„ Text       â”‚  â”‚ â”‚ Chart â”‚ â”‚   Table   â”‚ â”‚  â”‚ [____]  â”‚   â”‚
â”‚  â”‚  ğŸ–¼ï¸ Image      â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚         â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ Data:   â”‚   â”‚
â”‚  â”‚  Templates:    â”‚  â”‚ â”‚       Form          â”‚ â”‚  â”‚ [____]  â”‚   â”‚
â”‚  â”‚  â€¢ E-commerce  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚         â”‚   â”‚
â”‚  â”‚  â€¢ Dashboard   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚   â”‚
â”‚  â”‚  â€¢ Blog CMS    â”‚                               â”‚         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Features:                                                       â”‚
â”‚  â€¢ Drag components onto canvas                                   â”‚
â”‚  â€¢ Configure properties in sidebar                               â”‚
â”‚  â€¢ Connect to data sources                                       â”‚
â”‚  â€¢ Pre-built templates                                           â”‚
â”‚  â€¢ Export to React code                                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Component library (22 widget types)
- [ ] Drag-and-drop canvas (frontend - deferred)
- [ ] Property editor sidebar (frontend - deferred)
- [x] Data source connector (9 source types)
- [x] Template library (10 templates)
- [ ] WYSIWYG text editor (deferred)
- [x] Export to deployable React app

**Files to Create:**
```
frontend/src/components/AdminBuilder/
â”œâ”€â”€ Canvas.tsx
â”œâ”€â”€ ComponentLibrary.tsx
â”œâ”€â”€ PropertyEditor.tsx
â”œâ”€â”€ DataSourceConnector.tsx
â”œâ”€â”€ TemplateGallery.tsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChartWidget.tsx
â”‚   â”œâ”€â”€ TableWidget.tsx
â”‚   â”œâ”€â”€ FormWidget.tsx
â”‚   â””â”€â”€ ...
â””â”€â”€ index.ts

backend/apps/admin_builder/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ models.py          # AdminPage, Widget, Template
â”œâ”€â”€ views.py           # AdminBuilderViewSet
â””â”€â”€ export.py          # export_to_react
```

---

### Phase 12: Marketing Analysis âœ… COMPLETED
**Timeline: 2 weeks** â†’ Completed Nov 27, 2025
**Requirement: #14 (Competitor analysis via email)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MARKETING ANALYSIS SERVICE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Customer configures:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Competitors to track:                                    â”‚   â”‚
â”‚  â”‚  â€¢ competitor1.com                                        â”‚   â”‚
â”‚  â”‚  â€¢ competitor2.com                                        â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Keywords to monitor:                                     â”‚   â”‚
â”‚  â”‚  â€¢ "ai app builder"                                       â”‚   â”‚
â”‚  â”‚  â€¢ "no-code platform"                                     â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Report frequency: [Weekly â–¼]                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                      â”‚
â”‚                           â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              WEEKLY REPORT (emailed)                      â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  ğŸ“Š Competitor Analysis - Week of Nov 25                  â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  competitor1.com:                                         â”‚   â”‚
â”‚  â”‚  â€¢ New feature launched: "AI Templates"                   â”‚   â”‚
â”‚  â”‚  â€¢ Blog post: "How to build faster"                       â”‚   â”‚
â”‚  â”‚  â€¢ Traffic estimate: +15%                                 â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Keyword Rankings:                                        â”‚   â”‚
â”‚  â”‚  â€¢ "ai app builder" - You: #4, Comp1: #2                  â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  Recommendations:                                         â”‚   â”‚
â”‚  â”‚  â€¢ Consider adding AI templates feature                   â”‚   â”‚
â”‚  â”‚  â€¢ Create content around "fast building"                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Competitor tracking setup
- [x] Web scraper for competitor changes
- [x] Keyword rank tracker (SerpAPI or similar)
- [x] AI-powered analysis (summarize changes)
- [x] Report generation
- [x] Scheduled email delivery

**Files Created:**
```
backend/apps/marketing/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ apps.py            # App configuration
â”œâ”€â”€ models.py          # MarketingConfig, Competitor, CompetitorSnapshot, CompetitorChange, Keyword, KeywordRanking, MarketingReport, ReportTemplate
â”œâ”€â”€ scrapers.py        # CompetitorScraper, ChangeDetector, scrape_competitor_sync
â”œâ”€â”€ keyword_tracker.py # KeywordRankTracker, RankingAnalyzer
â”œâ”€â”€ analysis.py        # AIAnalyzer, InsightGenerator
â”œâ”€â”€ reports.py         # ReportGenerator, ReportDelivery
â”œâ”€â”€ tasks.py           # Celery tasks for scraping, keyword checking, report generation
â”œâ”€â”€ serializers.py     # API serializers
â”œâ”€â”€ views.py           # CompetitorViewSet, KeywordViewSet, MarketingReportViewSet, etc.
â”œâ”€â”€ urls.py            # URL routing
â”œâ”€â”€ admin.py           # Django admin configuration
â””â”€â”€ migrations/
    â””â”€â”€ 0001_initial.py
```

**API Endpoints:**
- `GET/POST /api/marketing/config/` - Marketing configuration
- `GET/POST /api/marketing/competitors/` - Competitor CRUD
- `POST /api/marketing/competitors/{id}/scrape/` - Trigger scraping
- `POST /api/marketing/competitors/scrape_all/` - Scrape all competitors
- `GET /api/marketing/changes/` - View competitor changes
- `GET/POST /api/marketing/keywords/` - Keyword CRUD
- `POST /api/marketing/keywords/{id}/check/` - Check keyword ranking
- `POST /api/marketing/keywords/check_all/` - Check all rankings
- `GET /api/marketing/reports/` - List reports
- `POST /api/marketing/reports/generate/` - Generate new report
- `GET /api/marketing/reports/{id}/html/` - Get HTML report
- `GET /api/marketing/dashboard/` - Marketing dashboard
- `GET /api/marketing/dashboard/insights/` - Get insights

---

### Phase 13: Code Library & Reuse System âœ… COMPLETED
**Timeline: 2-3 weeks** â†’ Completed Nov 27, 2025
**Requirements: #15 (Code reuse), #16 (MD constraints), #17 (Research before generate)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CODE LIBRARY SYSTEM                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              GENERATION FLOW (NEW)                        â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â”‚  User Request: "Add payment form"                         â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â–¼                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  STEP 1: SEARCH LIBRARY                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Query: "payment form stripe"                       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Found: PaymentForm_v3.tsx (95% match)              â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ REUSE EXISTING (no LLM call needed!)             â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â–¼ (if not found)                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  STEP 2: RESEARCH BEST PRACTICES                    â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Search web for "react payment form 2024"         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Check Stripe docs for latest patterns            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Review top GitHub repos                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â†’ Compile research summary                         â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â–¼                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  STEP 3: LOAD CONSTRAINTS (MD files)                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ /constraints/security.md                         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ /constraints/styling.md                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ /constraints/no-external-apis.md                 â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â–¼                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  STEP 4: GENERATE WITH LLM                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Prompt includes:                                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ User request                                     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Research findings                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Constraints from MD files                        â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚                                                 â”‚   â”‚
â”‚  â”‚         â–¼                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚  STEP 5: ADD TO LIBRARY                             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Tag with metadata (category, keywords)           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Version control                                  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Quality score                                    â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Library Structure:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /library/                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ components/                                          â”‚   â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ PaymentForm_v3.tsx                              â”‚   â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ DataTable_v2.tsx                                â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ ...                                             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ services/                                            â”‚   â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ StripeService_v1.py                             â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ ...                                             â”‚   â”‚
â”‚  â”‚  â””â”€â”€ templates/                                           â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ ecommerce_dashboard.json                        â”‚   â”‚
â”‚  â”‚      â””â”€â”€ ...                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Constraint Files:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /constraints/                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ security.md      # No eval(), sanitize inputs       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ styling.md       # Use inline styles, dark theme    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ apis.md          # Only use gateway, no direct      â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ react.md         # Hooks only, no class components  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ database.md      # Use Faibric DB API patterns      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tasks:**
- [x] Code library database (with embeddings for search)
- [x] Library search API (semantic + keyword + hybrid)
- [x] Research service (web search, GitHub, NPM, PyPI)
- [x] Constraint loader (parse MD files)
- [x] Generation pipeline with research step
- [x] Auto-add to library after generation
- [x] Version control for library items
- [x] Quality scoring system

**Files Created:**
```
backend/apps/code_library/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ apps.py
â”œâ”€â”€ models.py          # LibraryItem, LibraryVersion, LibraryCategory, Constraint, ResearchCache
â”œâ”€â”€ search.py          # LibrarySearchService (semantic, keyword, hybrid)
â”œâ”€â”€ embeddings.py      # EmbeddingService, CodeEmbedder
â”œâ”€â”€ serializers.py     # API serializers
â”œâ”€â”€ views.py           # LibraryItemViewSet, ConstraintViewSet, CodeGenerationViewSet
â”œâ”€â”€ urls.py
â”œâ”€â”€ admin.py
â””â”€â”€ migrations/

backend/apps/ai_engine/v6/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ research.py        # ResearchService (web, GitHub, NPM, PyPI)
â”œâ”€â”€ constraints.py     # ConstraintLoader, ConstraintManager
â”œâ”€â”€ pipeline.py        # CodeGenerationPipeline
â””â”€â”€ prompts.py         # PromptBuilder, LibraryItemPromptBuilder

constraints/
â”œâ”€â”€ security.md        # Security best practices
â”œâ”€â”€ styling.md         # CSS/styling guidelines
â”œâ”€â”€ apis.md            # API usage patterns
â”œâ”€â”€ react.md           # React component patterns
â””â”€â”€ database.md        # Database usage patterns
```

**API Endpoints:**
- `GET/POST /api/library/items/` - Library items CRUD
- `POST /api/library/items/search/` - Search (semantic/keyword/hybrid)
- `POST /api/library/items/{id}/use/` - Record usage
- `GET /api/library/items/{id}/versions/` - Version history
- `POST /api/library/items/{id}/add_version/` - Add new version
- `GET/POST /api/library/categories/` - Categories
- `GET/POST /api/library/constraints/` - Constraints CRUD
- `POST /api/library/constraints/sync_from_files/` - Sync MD files
- `GET /api/library/constraints/for_generation/` - Get constraints for prompt
- `POST /api/library/generate/generate/` - Full generation pipeline
- `POST /api/library/generate/research/` - Research a topic
- `POST /api/library/generate/search_first/` - Search library before generating

**Key Features:**
- ğŸ” Hybrid search (semantic embeddings + keyword matching)
- ğŸ“š Code reuse with versioning
- ğŸ”¬ Research-driven generation (web, GitHub, npm, pypi)
- ğŸ“‹ MD-based constraint system
- ğŸ¤– Enhanced LLM prompts with context
- â­ Quality scoring and usage tracking

---

## Implementation Timeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    IMPLEMENTATION TIMELINE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  MONTH 1:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1-2: Phase 1 (Security & Multi-tenancy)               â”‚
â”‚  â””â”€â”€ Week 3-4: Phase 2 (Billing)                                â”‚
â”‚                                                                  â”‚
â”‚  MONTH 2:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1-2: Phase 3 (Analytics) + Phase 4 (AI Chat)          â”‚
â”‚  â””â”€â”€ Week 3-4: Phase 5 (Messaging) + Phase 6 (Forum)            â”‚
â”‚                                                                  â”‚
â”‚  MONTH 3:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1: Phase 7 (Storage)                                  â”‚
â”‚  â”œâ”€â”€ Week 2-3: Phase 8 (Recommendations)                        â”‚
â”‚  â””â”€â”€ Week 4: Phase 9 (Checkout)                                 â”‚
â”‚                                                                  â”‚
â”‚  MONTH 4:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1-2: Phase 10 (Cabinets) + Phase 12 (Marketing)       â”‚
â”‚  â””â”€â”€ Week 3-4: Phase 11 (Admin Builder - part 1)                â”‚
â”‚                                                                  â”‚
â”‚  MONTH 5:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1-2: Phase 11 (Admin Builder - part 2)                â”‚
â”‚  â””â”€â”€ Week 3-4: Phase 13 (Code Library)                          â”‚
â”‚                                                                  â”‚
â”‚  MONTH 6:                                                        â”‚
â”‚  â”œâ”€â”€ Week 1-2: Integration testing                              â”‚
â”‚  â”œâ”€â”€ Week 3: Security audit                                     â”‚
â”‚  â””â”€â”€ Week 4: Beta launch                                        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Priority Order

| Priority | Phase | Requirement | Why |
|----------|-------|-------------|-----|
| ğŸ”´ P0 | 1 | Security | Foundation - nothing works without it |
| ğŸ”´ P0 | 2 | Billing | Revenue - customers must pay |
| ğŸŸ  P1 | 13 | Code Library | Saves tokens, improves quality |
| ğŸŸ  P1 | 4 | AI Chat/Multi-LLM | Core differentiator |
| ğŸŸ  P1 | 9 | Checkout | Customers need to sell |
| ğŸŸ¡ P2 | 11 | Admin Panel | Big value-add |
| ğŸŸ¡ P2 | 3 | Analytics | Customers need data |
| ğŸŸ¡ P2 | 7 | Storage | Required for most apps |
| ğŸŸ¢ P3 | 5 | Messaging | Nice to have |
| ğŸŸ¢ P3 | 6 | Forum | Nice to have |
| ğŸŸ¢ P3 | 8 | Recommendations | Advanced feature |
| ğŸŸ¢ P3 | 10 | Cabinets | Advanced feature |
| ğŸŸ¢ P3 | 12 | Marketing | Advanced feature |

---

## Tech Stack Additions

| Service | Technology Options |
|---------|-------------------|
| Multi-LLM | OpenAI, Anthropic, Google AI, xAI |
| Payments | Stripe, PayPal |
| Email | SendGrid, Mailgun, AWS SES |
| SMS | Twilio, Vonage |
| Storage | AWS S3, Cloudflare R2, GCS |
| Analytics | Mixpanel, Amplitude, PostHog |
| Search | Elasticsearch, Meilisearch, Algolia |
| Vector DB | Pinecone, Weaviate, pgvector |
| Cache | Redis, Memcached |
| Queue | Celery + Redis, AWS SQS |

---

## API Keys Needed

Add to `.env`:

```bash
# LLMs
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GOOGLE_AI_API_KEY=
XAI_API_KEY=

# Payments
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
PAYPAL_CLIENT_ID=
PAYPAL_SECRET=

# Email
SENDGRID_API_KEY=
MAILCHIMP_API_KEY=

# SMS
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=

# Storage
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_BUCKET=

# Analytics
MIXPANEL_TOKEN=
GA_MEASUREMENT_ID=

# Search/Research
SERP_API_KEY=
```

---

## Success Metrics

| Metric | Target |
|--------|--------|
| Customer onboarding time | < 5 minutes |
| Time to first deployed app | < 10 minutes |
| Code library hit rate | > 60% (reuse vs generate) |
| Token cost per app | < $0.50 |
| Customer churn | < 5% monthly |
| Uptime | 99.9% |

